<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—ã–∫–∞–π –≤ –∫—Ä—É–∂–∫–∏</title>
    <style>
        * {
            box-sizing: border-box;
            user-select: none;
        }

        body {
            margin: 0;
            min-height: 100vh;
            background: linear-gradient(135deg, #1e2b3a, #0f1a24);
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
        }

        .game-container {
            background: #243b4a;
            border-radius: 2rem;
            padding: 1.5rem;
            box-shadow: 0 20px 30px rgba(0, 0, 0, 0.6), inset 0 0 8px #4e7b99;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            background: #1d2e3a;
            padding: 0.8rem 1.5rem;
            border-radius: 3rem;
            margin-bottom: 1.5rem;
            color: white;
            font-weight: 700;
            font-size: 1.5rem;
            box-shadow: inset 0 2px 5px #0b151d, 0 5px 0 #0f1a22;
        }

        .score, .timer {
            background: #0e1a24;
            padding: 0.3rem 1.2rem;
            border-radius: 2rem;
            box-shadow: inset 0 1px 4px #5a7e9b;
        }

        .play-area {
            position: relative;
            width: 700px;
            height: 400px;
            background: #1b2e3f;
            border-radius: 2rem;
            box-shadow: inset 0 0 20px #0a141e, 0 10px 10px rgba(0,0,0,0.5);
            overflow: hidden;
            cursor: crosshair;
            border: 3px solid #3f627c;
        }

        .circle {
            position: absolute;
            width: 50px;
            height: 50px;
            background: radial-gradient(circle at 30% 30%, #ffd966, #e68900);
            border-radius: 50%;
            box-shadow: 0 6px 0 #a45d00, 0 10px 15px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: transform 0.1s ease, box-shadow 0.1s ease;
            will-change: transform;
        }

        .circle:hover {
            transform: scale(1.1);
            background: radial-gradient(circle at 30% 30%, #ffe085, #ffa500);
            box-shadow: 0 8px 0 #b36b00, 0 15px 20px rgba(0,0,0,0.4);
        }

        .circle:active {
            transform: scale(0.95);
            box-shadow: 0 3px 0 #a45d00, 0 8px 10px rgba(0,0,0,0.3);
        }

        .game-over-message {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 20, 30, 0.85);
            backdrop-filter: blur(4px);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 2rem;
            font-weight: bold;
            border-radius: 2rem;
            z-index: 10;
            text-shadow: 2px 2px 0 #0a121b;
        }

        .game-over-message p {
            margin: 0.5rem 0;
        }

        .final-score {
            font-size: 3.5rem;
            color: #ffd966;
        }

        .new-game-btn {
            background: #f4b642;
            border: none;
            color: #1d2e3a;
            font-size: 1.5rem;
            font-weight: bold;
            padding: 0.8rem 2rem;
            border-radius: 3rem;
            margin-top: 1rem;
            box-shadow: 0 7px 0 #b16f1a, 0 10px 20px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: 0.07s ease;
        }

        .new-game-btn:active {
            transform: translateY(5px);
            box-shadow: 0 2px 0 #b16f1a, 0 8px 15px rgba(0,0,0,0.3);
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="stats">
            <div class="score">üíØ <span id="scoreDisplay">0</span></div>
            <div class="timer">‚è≥ <span id="timerDisplay">30</span>—Å</div>
        </div>

        <div class="play-area" id="playArea">
            <!-- —Å—é–¥–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∫—Ä—É–∂–∫–∏ -->
            <div id="gameOverlay" class="game-over-message hidden">
                <p>–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</p>
                <p class="final-score" id="finalScore">0</p>
                <button class="new-game-btn" id="restartBtn">üç© –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            </div>
        </div>
    </div>

    <script>
        (function() {
            // ----- –≠–ª–µ–º–µ–Ω—Ç—ã DOM -----
            const playArea = document.getElementById('playArea');
            const scoreSpan = document.getElementById('scoreDisplay');
            const timerSpan = document.getElementById('timerDisplay');
            const gameOverlay = document.getElementById('gameOverlay');
            const finalScoreSpan = document.getElementById('finalScore');
            const restartBtn = document.getElementById('restartBtn');

            // ----- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–≥—Ä—ã -----
            const INIT_TIME = 30;           // —Å–µ–∫—É–Ω–¥
            const CIRCLE_LIFETIME = 3000;    // –º—Å (3 —Å–µ–∫—É–Ω–¥—ã)
            const SPAWN_INTERVAL = 1000;      // –º—Å (1 –∫—Ä—É–≥ –≤ —Å–µ–∫—É–Ω–¥—É)

            // ----- –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã -----
            let score = 0;
            let timeLeft = INIT_TIME;
            let gameActive = false;           // true ‚Äì –∏–≥—Ä–∞ –∏–¥—ë—Ç
            let timerInterval = null;
            let spawnInterval = null;

            // –•—Ä–∞–Ω–∏–º –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Ç–∞–π–º–µ—Ä—ã —É–¥–∞–ª–µ–Ω–∏—è –∫—Ä—É–∂–∫–æ–≤, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Ö –æ—Ç–º–µ–Ω–∏—Ç—å –ø—Ä–∏ –∫–ª–∏–∫–µ
            // (–º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä—è–º–æ –≤ —ç–ª–µ–º–µ–Ω—Ç–µ —á–µ—Ä–µ–∑ data, –Ω–æ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Å–±–æ—Ä–∫–∏ –ø—Ä–∏ —Å–±—Ä–æ—Å–µ –æ—á–∏—Å—Ç–∏–º –≤—Å–µ)
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–∞—Å—Å–∏–≤ –¥–ª—è –≤—Å–µ—Ö setTimeOut, —á—Ç–æ–±—ã –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ –∏—Ö —É–±–∏—Ç—å.
            let circleTimeouts = [];

            // ----- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ -----

            // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∞–π–º–µ—Ä—ã —É–¥–∞–ª–µ–Ω–∏—è –∫—Ä—É–∂–∫–æ–≤
            function clearAllCircleTimeouts() {
                circleTimeouts.forEach(timeout => clearTimeout(timeout));
                circleTimeouts = [];
            }

            // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã (—Ç–∞–π–º–µ—Ä –∏ —Å–ø–∞–≤–Ω)
            function stopAllIntervals() {
                if (timerInterval) {
                    clearInterval(timerInterval);
                    timerInterval = null;
                }
                if (spawnInterval) {
                    clearInterval(spawnInterval);
                    spawnInterval = null;
                }
            }

            // –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫—Ä—É–∂–∫–∏ —Å –ø–æ–ª—è
            function removeAllCircles() {
                const circles = playArea.querySelectorAll('.circle');
                circles.forEach(circle => circle.remove());
                clearAllCircleTimeouts(); // —Ç–∞–π–º–µ—Ä—ã –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã
            }

            // –û–±–Ω–æ–≤–∏—Ç—å —Å—á—ë—Ç –Ω–∞ —ç–∫—Ä–∞–Ω–µ
            function updateScoreDisplay() {
                scoreSpan.textContent = score;
            }

            // –û–±–Ω–æ–≤–∏—Ç—å —Ç–∞–π–º–µ—Ä –Ω–∞ —ç–∫—Ä–∞–Ω–µ
            function updateTimerDisplay() {
                timerSpan.textContent = timeLeft;
            }

            // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã (–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ–≥–æ, –ø–æ–∫–∞–∑ —ç–∫—Ä–∞–Ω–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º)
            function endGame() {
                gameActive = false;
                stopAllIntervals();

                // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫—Ä—É–∂–∫–∏ (–æ–Ω–∏ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã, –¥–∞ –∏ –∫–ª–∏–∫–∞—Ç—å –ø–æ –Ω–∏–º –Ω–µ–ª—å–∑—è)
                removeAllCircles();

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–≤–µ—Ä–ª–µ–π
                finalScoreSpan.textContent = score;
                gameOverlay.classList.remove('hidden');
            }

            // –ó–∞–ø—É—Å–∫ –Ω–æ–≤–æ–π –∏–≥—Ä—ã
            function startNewGame() {
                // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
                gameActive = true;
                score = 0;
                timeLeft = INIT_TIME;
                updateScoreDisplay();
                updateTimerDisplay();

                // –°–ø—Ä—è—Ç–∞—Ç—å –æ–≤–µ—Ä–ª–µ–π
                gameOverlay.classList.add('hidden');

                // –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª–µ –æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫—Ä—É–∂–∫–æ–≤ –∏ —Ç–∞–π–º–µ—Ä–æ–≤
                removeAllCircles();

                // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)
                stopAllIntervals();

                // –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ç—Å—á—ë—Ç –≤—Ä–µ–º–µ–Ω–∏
                timerInterval = setInterval(() => {
                    if (!gameActive) return; // –∑–∞—â–∏—Ç–∞

                    timeLeft -= 1;
                    updateTimerDisplay();

                    if (timeLeft <= 0) {
                        timeLeft = 0;
                        updateTimerDisplay();
                        endGame();
                    }
                }, 1000);

                // –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–ø–∞–≤–Ω –∫—Ä—É–∂–∫–æ–≤
                spawnInterval = setInterval(() => {
                    if (!gameActive) return; // –µ—Å–ª–∏ –∏–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞, –Ω–µ —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–µ –∫—Ä—É–∂–∫–∏
                    createCircle();
                }, SPAWN_INTERVAL);

                // –°—Ä–∞–∑—É —Å–æ–∑–¥–∞–¥–∏–º –ø–µ—Ä–≤—ã–π –∫—Ä—É–∂–æ–∫, —á—Ç–æ–±—ã –Ω–µ –∂–¥–∞—Ç—å —Å–µ–∫—É–Ω–¥—É
                createCircle();
            }

            // –°–æ–∑–¥–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∫—Ä—É–∂–∫–∞ –≤ —Å–ª—É—á–∞–π–Ω–æ–º –º–µ—Å—Ç–µ
            function createCircle() {
                if (!gameActive) return; // –ª–∏—à–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞

                const circle = document.createElement('div');
                circle.className = 'circle';

                // –°–ª—É—á–∞–π–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö playArea (—Å —É—á—ë—Ç–æ–º —Ä–∞–∑–º–µ—Ä–∞ –∫—Ä—É–∂–∫–∞ 50x50)
                const maxLeft = playArea.clientWidth - 50;
                const maxTop = playArea.clientHeight - 50;

                // –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–¥—Ä—É–≥ –º–µ–Ω—å—à–µ 50px (–Ω–æ —É –Ω–∞—Å 700x400)
                const left = Math.max(0, Math.floor(Math.random() * maxLeft));
                const top = Math.max(0, Math.floor(Math.random() * maxTop));

                circle.style.left = left + 'px';
                circle.style.top = top + 'px';

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
                circle.addEventListener('click', function onClick(event) {
                    event.stopPropagation(); // –Ω–µ –≤—Å–ø–ª—ã–≤–∞–µ—Ç, –Ω–æ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
                    if (!gameActive) return; // –µ—Å–ª–∏ –∏–≥—Ä–∞ —É–∂–µ –Ω–µ –∞–∫—Ç–∏–≤–Ω–∞, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º

                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç
                    score += 1;
                    updateScoreDisplay();

                    // –£–¥–∞–ª—è–µ–º –∫—Ä—É–∂–æ–∫ –∏ –æ—Ç–º–µ–Ω—è–µ–º –µ–≥–æ —Ç–∞–π–º–µ—Ä —Å–∞–º–æ—É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è
                    const timeoutId = circle.dataset.timeoutId;
                    if (timeoutId) {
                        clearTimeout(Number(timeoutId));
                        // –£–¥–∞–ª—è–µ–º –∏–∑ –º–∞—Å—Å–∏–≤–∞ circleTimeouts
                        circleTimeouts = circleTimeouts.filter(id => id !== Number(timeoutId));
                    }

                    // –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑ DOM
                    circle.remove();
                });

                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞ –ø–æ–ª–µ
                playArea.appendChild(circle);

                // –°—Ç–∞–≤–∏–º —Ç–∞–π–º–µ—Ä –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω–µ –∫–ª–∏–∫–Ω—É–ª–∏)
                const timeoutId = setTimeout(() => {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –µ—â—ë —ç—Ç–æ—Ç –∫—Ä—É–∂–æ–∫ –∏ –∞–∫—Ç–∏–≤–Ω–∞ –ª–∏ –∏–≥—Ä–∞ (–∫—Ä—É–∂–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–∂–µ —É–¥–∞–ª—ë–Ω)
                    if (circle.parentNode) {
                        circle.remove(); // —É–±–∏—Ä–∞–µ–º —Å –ø–æ–ª—è
                    }
                    // –£–±–∏—Ä–∞–µ–º —ç—Ç–æ—Ç timeout –∏–∑ –º–∞—Å—Å–∏–≤–∞
                    circleTimeouts = circleTimeouts.filter(id => id !== timeoutId);
                }, CIRCLE_LIFETIME);

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º id —Ç–∞–π–º–µ—Ä–∞ –≤ data-–∞—Ç—Ä–∏–±—É—Ç –∏ –≤ –º–∞—Å—Å–∏–≤
                circle.dataset.timeoutId = timeoutId;
                circleTimeouts.push(timeoutId);
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ù–æ–≤–∞—è –∏–≥—Ä–∞"
            restartBtn.addEventListener('click', () => {
                startNewGame();
            });

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: —Å—Ä–∞–∑—É –∑–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            startNewGame();

            // –ù–µ–±–æ–ª—å—à–∞—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞: –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Å–∞–º—É –æ–±–ª–∞—Å—Ç—å –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∏—á–µ–≥–æ –ª–∏—à–Ω–µ–≥–æ
            playArea.addEventListener('click', (e) => {
                // –ï—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –Ω–∞ –ø—É—Å—Ç–æ–µ –º–µ—Å—Ç–æ (–Ω–µ –Ω–∞ –∫—Ä—É–∂–æ–∫) ‚Äì –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
                // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∑–≤—É–∫ –∏–ª–∏ —á—Ç–æ‚Äë—Ç–æ –µ—â—ë, –Ω–æ –Ω–µ –Ω—É–∂–Ω–æ.
            });

        })();
    </script>
</body>
</html>